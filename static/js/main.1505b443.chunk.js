(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],{10:function(e,t,a){e.exports=a(16)},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(5),r=a.n(c),i=(a(15),a(9)),l=a(1),s=a(6),u=a.n(s);var p=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:u.a,alt:"\u041c\u0435\u0441\u0442\u043e \u0420\u043e\u0441\u0441\u0438\u044f"}))},m=o.a.createContext();var d=function(e){var t=e.card,a=e.onClick,n=e.onCardLike,c=e.onCardDelete,r=o.a.useContext(m),i=t.owner._id===r._id,l=t.likes.some((function(e){return e._id===r._id})),s="card__btn-delete ".concat(i?"":"card__btn-delete_invis"),u="card__btn-like ".concat(l?"card__btn-like_active":"");return o.a.createElement("li",{className:"card"},o.a.createElement("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){a(t)}}),o.a.createElement("button",{type:"button",className:s,onClick:function(){c(t)}}),o.a.createElement("div",{className:"card__text"},o.a.createElement("p",{className:"card__title"},t.name),o.a.createElement("div",{className:"card__like"},o.a.createElement("button",{type:"button",className:u,onClick:function(){n(t)}}),o.a.createElement("p",{className:"card__number-likes"},t.likes.length))))};var _=function(e){var t=Object(n.useContext)(m);return o.a.createElement(o.a.Fragment,null,o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("button",{className:"profile__btn profile__btn_avatar",onClick:e.onEditAvatar},o.a.createElement("img",{className:"profile__avatar",src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__name"},t.name),o.a.createElement("button",{type:"button",className:"profile__btn profile__btn_edit",onClick:e.onEditProfile}),o.a.createElement("p",{className:"profile__job"},t.about)),o.a.createElement("button",{type:"button",className:"profile__btn profile__btn_add",onClick:e.onAddPlace})),o.a.createElement("section",{className:"place"},o.a.createElement("ul",{className:"place__list"},e.cards.map((function(t){return o.a.createElement(d,{card:t,key:t._id,onClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))))};var f=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__text"},"\xa9 2020 Mesto Russia"))};var h=function(e){var t=e.card,a=e.onClose,n=e.isOpen&&"popup_opened";return o.a.createElement("div",{className:"popup popup_type_photo ".concat(n)},o.a.createElement("div",{className:"popup__container_photo"},o.a.createElement("img",{className:"popup__picture",src:t?t.link:"#",alt:t?t.name:""}),o.a.createElement("h3",{className:"popup__caption"},t?t.name:""),o.a.createElement("button",{type:"button",className:"popup__close",onClick:function(){a()}})))};var b=function(e){return o.a.createElement("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container popup__container_".concat(e.name)},o.a.createElement("h3",{className:"popup__title"},e.title),o.a.createElement("form",{className:"popup__form",name:e.name,noValidate:!0,onSubmit:e.onSubmit},e.children,o.a.createElement("button",{type:"submit",className:"popup__button"},e.button_text)),o.a.createElement("button",{type:"button",className:"popup__close",onClick:e.onClose})))};var E=function(e){var t=Object(n.useContext)(m),a=Object(n.useState)(""),c=Object(l.a)(a,2),r=c[0],i=c[1],s=Object(n.useState)(""),u=Object(l.a)(s,2),p=u[0],d=u[1];return Object(n.useEffect)((function(){i(t.name),d(t.about)}),[t]),o.a.createElement(b,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",button_text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:p}),t.target.reset()}},o.a.createElement("label",{className:"popup__field"},o.a.createElement("input",{name:"name",type:"text",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_name",maxLength:"40",minLength:"2",id:"name",value:r||"",onChange:function(e){i(e.target.value)},required:!0}),o.a.createElement("span",{className:"popup__error",id:"name-error"})),o.a.createElement("label",{className:"popup__field"},o.a.createElement("input",{name:"job",type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_job",maxLength:"200",minLength:"2",id:"job",value:p||"",onChange:function(e){d(e.target.value)},required:!0}),o.a.createElement("span",{className:"popup__error",id:"job-error"})))};var v=function(e){var t=Object(n.useRef)();return o.a.createElement(b,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",button_text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar(t.current.value),a.target.reset()}},o.a.createElement("label",{className:"popup__field"},o.a.createElement("input",{name:"avatar",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043d\u043e\u0432\u044b\u0439 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__input",id:"avatar",required:!0,ref:t}),o.a.createElement("span",{className:"popup__error",id:"avatar-error"})))},C=a(7),k=a(8),N=new(function(){function e(t){var a=t.serverUrl,n=t.authorization;Object(C.a)(this,e),this._serverUrl=a,this._authorization=n}return Object(k.a)(e,[{key:"_fetch",value:function(e,t){return fetch(this._serverUrl+e,t).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._fetch("/users/me",{method:"GET",headers:{authorization:this._authorization}})}},{key:"setUserInfo",value:function(e){return this._fetch("/users/me",{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})})}},{key:"setUserAvatar",value:function(e){return this._fetch("/users/me/avatar",{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})})}},{key:"getInitialCards",value:function(){return this._fetch("/cards",{method:"GET",headers:{authorization:this._authorization}})}},{key:"createCard",value:function(e){return this._fetch("/cards",{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})})}},{key:"deleteCard",value:function(e){return this._fetch("/cards/".concat(e),{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}})}},{key:"createLike",value:function(e){return this._fetch("/cards/likes/".concat(e),{method:"PUT",headers:{authorization:this._authorization,"Content-Type":"application/json"}})}},{key:"deleteLike",value:function(e){return this._fetch("/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}})}},{key:"changeLikeCardStatus",value:function(e,t){return this._fetch("/cards/likes/".concat(e),{method:t?"PUT":"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}})}}]),e}())({serverUrl:"https://mesto.nomoreparties.co/v1/cohort-14",authorization:"7a3dfd49-072e-4055-86f4-4cec12a9c522"});var O=function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1];return o.a.createElement(b,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",button_text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:c,link:u})}},o.a.createElement("label",{className:"popup__field"},o.a.createElement("input",{name:"name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_mesto",maxLength:"30",minLength:"1",id:"mesto",required:!0,value:c,onChange:function(e){r(e.target.value)}}),o.a.createElement("span",{className:"popup__error",id:"mesto-error"})),o.a.createElement("label",{className:"popup__field"},o.a.createElement("input",{name:"src",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_src",id:"src",required:!0,value:u,onChange:function(e){p(e.target.value)}}),o.a.createElement("span",{className:"popup__error",id:"src-error"})))};var j=function(e){var t=e.card,a=e.isOpen,n=e.onClose,c=e.onDeleteCard;return o.a.createElement(b,{name:"verification",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",button_text:"\u0414\u0410",isOpen:a,onClose:n,onSubmit:function(e){e.preventDefault(),c(t)}})};var g=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),s=Object(l.a)(r,2),u=s[0],d=s[1],b=Object(n.useState)(!1),C=Object(l.a)(b,2),k=C[0],g=C[1],y=Object(n.useState)(!1),S=Object(l.a)(y,2),L=S[0],z=S[1],x=Object(n.useState)(!1),U=Object(l.a)(x,2),T=U[0],D=U[1],P=Object(n.useState)(null),A=Object(l.a)(P,2),I=A[0],w=A[1],q=Object(n.useState)(""),J=Object(l.a)(q,2),G=J[0],H=J[1],M=Object(n.useState)([]),R=Object(l.a)(M,2),B=R[0],F=R[1];function V(e){"Escape"===e.key&&W()}function K(e){e.target.classList.contains("popup")&&W()}function Q(){document.addEventListener("keydown",V),document.addEventListener("click",K)}function W(){c(!1),d(!1),g(!1),z(!1),D(!1),w(null),document.removeEventListener("keydown",V),document.removeEventListener("click",K)}return Object(n.useEffect)((function(){N.getUserInfo().then((function(e){H(e)})).catch((function(e){console.log("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b. ".concat(e))}))}),[]),Object(n.useEffect)((function(){N.getInitialCards().then((function(e){F(e)})).catch((function(e){console.log("\u0414\u0430\u043d\u043d\u044b\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b. ".concat(e))}))}),[]),o.a.createElement(m.Provider,{value:G},o.a.createElement("div",{className:"page"},o.a.createElement(p,null),o.a.createElement(_,{cards:B,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===G._id}));N.changeLikeCardStatus(e._id,!t).then((function(t){var a=B.map((function(a){return a._id===e._id?t:a}));F(a)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043b\u0430\u0439\u043a\u0430. ".concat(e))}))},onCardDelete:function(e){z(!0),w(e),Q()},onEditAvatar:function(){c(!0),Q()},onEditProfile:function(){d(!0),Q()},onAddPlace:function(){g(!0),Q()},onCardClick:function(e){D(!0),w(e),Q()}}),o.a.createElement(f,null),o.a.createElement(E,{isOpen:u,onClose:W,onUpdateUser:function(e){N.setUserInfo(e).then((function(e){H(e),W()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. ".concat(e))})).finally((function(){}))}}),o.a.createElement(v,{isOpen:a,onClose:W,onUpdateAvatar:function(e){N.setUserAvatar(e).then((function(e){H(e),W()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0430\u0432\u0430\u0442\u0430\u0440\u0430. ".concat(e))})).finally((function(){}))}}),o.a.createElement(O,{isOpen:k,onClose:W,onAddPlace:function(e){N.createCard(e).then((function(e){F([e].concat(Object(i.a)(B))),W()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438. ".concat(e))})).finally((function(){}))}}),o.a.createElement(h,{isOpen:T,card:I,onClose:W}),o.a.createElement(j,{isOpen:L,onClose:W,onDeleteCard:function(e){N.deleteCard(e._id).then((function(){var t=B.filter((function(t){return t._id!==e._id}));F(t),W()})).catch((function(e){console.log("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e. ".concat(e))}))},card:I})))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(g,null)),document.getElementById("root"))},6:function(e,t,a){e.exports=a.p+"static/media/logo.0fce8a33.svg"}},[[10,1,2]]]);
//# sourceMappingURL=main.1505b443.chunk.js.map